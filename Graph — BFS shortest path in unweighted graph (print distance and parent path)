#include <stdio.h>
#include <stdlib.h>
#define INF 1000000000

/* Simple adjacency list using arrays of vectors */
typedef struct Vec {
    int *a; int sz, cap;
} Vec;
void vecInit(Vec* v){ v->a = NULL; v->sz=0; v->cap=0; }
void vecPush(Vec* v, int x){
    if(v->sz==v->cap){ v->cap = v->cap? v->cap*2:4; v->a = realloc(v->a, v->cap * sizeof(int)); }
    v->a[v->sz++] = x;
}

int main(){
    int n = 6; // nodes 0..5
    Vec *adj = malloc(n * sizeof(Vec));
    for(int i=0;i<n;i++) vecInit(&adj[i]);
    // sample edges (undirected)
    vecPush(&adj[0],1); vecPush(&adj[1],0);
    vecPush(&adj[0],2); vecPush(&adj[2],0);
    vecPush(&adj[1],3); vecPush(&adj[3],1);
    vecPush(&adj[2],3); vecPush(&adj[3],2);
    vecPush(&adj[3],4); vecPush(&adj[4],3);
    vecPush(&adj[4],5); vecPush(&adj[5],4);

    int s = 0, t = 5;
    int *dist = malloc(n*sizeof(int));
    int *par = malloc(n*sizeof(int));
    for(int i=0;i<n;i++){ dist[i]=INF; par[i]=-1; }

    // BFS queue
    int *q = malloc(n * sizeof(int));
    int qh=0, qt=0;
    dist[s]=0; q[qt++]=s;
    while(qh<qt){
        int u = q[qh++];
        for(int i=0;i<adj[u].sz;i++){
            int v = adj[u].a[i];
            if(dist[v]==INF){
                dist[v]=dist[u]+1;
                par[v]=u;
                q[qt++]=v;
            }
        }
    }

    if(dist[t]==INF) { printf("No path\n"); return 0; }
    printf("Distance: %d\n", dist[t]); // shortest distance
    // reconstruct
    int cur = t;
    int path[100]; int pn=0;
    while(cur!=-1){ path[pn++]=cur; cur=par[cur]; }
    for(int i=pn-1;i>=0;i--) printf("%d%c", path[i], i? ' ':'\n');

    return 0;
}
